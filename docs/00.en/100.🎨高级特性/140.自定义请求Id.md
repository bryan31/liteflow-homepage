---
title: ğŸ§è‡ªå®šä¹‰è¯·æ±‚Id
date: 2022-07-03 11:12:53
permalink: /pages/advance/customid/
---

LiteFlowæ”¯æŒè®©ä½ è‡ªå®šä¹‰ä½ çš„è¯·æ±‚Idã€‚

å¤§å®¶åœ¨æ‰§è¡Œä¸€æ¡æµç¨‹çš„æ—¶å€™ï¼Œå¾€å¾€å¯ä»¥åœ¨æ—¥å¿—ä¿¡æ¯ä¸­çœ‹åˆ°ä»¥ä¸‹ç±»ä¼¼çš„ä¿¡æ¯ï¼š

```
2022-07-03 11:15:00.196  INFO 71275 --- [           main] com.yomahub.liteflow.flow.element.Node   : [067a0baa6d434de3a8ccafa4b1506562]:[O]start component[a] execution
2022-07-03 11:15:00.204  INFO 71275 --- [           main] com.yomahub.liteflow.flow.element.Node   : [067a0baa6d434de3a8ccafa4b1506562]:[O]start component[b] execution
2022-07-03 11:15:00.218  INFO 71275 --- [lf-when-thead-0] com.yomahub.liteflow.flow.element.Node   : [067a0baa6d434de3a8ccafa4b1506562]:[O]start component[c] execution
2022-07-03 11:15:00.220  INFO 71275 --- [lf-when-thead-1] com.yomahub.liteflow.flow.element.Node   : [067a0baa6d434de3a8ccafa4b1506562]:[O]start component[d] execution
2022-07-03 11:15:00.220  INFO 71275 --- [           main] com.yomahub.liteflow.slot.Slot           : [067a0baa6d434de3a8ccafa4b1506562]:CHAIN_NAME[chain1]
a<1>==>b<0>==>c<0>==>d<0>
2022-07-03 11:15:00.221  INFO 71275 --- [           main] com.yomahub.liteflow.slot.DataBus        : [067a0baa6d434de3a8ccafa4b1506562]:slot[0] released
```

å…¶ä¸­æ—¥å¿—ä¸»ä½“ä¸­æœ€å‰é¢çš„å°±æ˜¯RequestIdï¼Œä¸€ä¸ªè¯·æ±‚ä¸­çš„requestIdéƒ½æ˜¯ç›¸åŒçš„ï¼Œæ–¹ä¾¿ä½ è¿›è¡Œæ—¥å¿—æŸ¥æ‰¾ã€‚

è¿™ä¸ªrequestIdçš„å½¢å¼ä¹Ÿæ˜¯å¯ä»¥è‡ªå®šä¹‰çš„ã€‚ä½ å¯ä»¥æŒ‰ç…§è‡ªå·±çš„è§„åˆ™ç”Ÿæˆï¼Œä¹Ÿå¯ä»¥ä¼ å…¥æœ¬æ¥å·²æœ‰çš„TraceIdæ¥å’Œç³»ç»Ÿåšé›†æˆã€‚

## æŒ‰ç…§è‡ªå·±çš„è§„åˆ™ç”Ÿæˆ

ä½ åªéœ€è¦è¦å£°æ˜ä¸€ä¸ªç±»ï¼Œç„¶åå®ç°`RequestIdGenerator`æ¥å£å³å¯ï¼š

```java
public class CustomRequestIdGenerator implements RequestIdGenerator {

    @Override
    public String generate() {
        return System.nanoTime();
    }
}
```

ç„¶ååœ¨LiteFlowçš„é…ç½®æ–‡ä»¶é‡Œå£°æ˜ä¸‹ä½ è¿™ä¸ªç±»å³å¯ï¼š

```properties
liteflow.request-id-generator-class=com.yomahub.liteflow.test.requestId.config.CustomRequestIdGenerator
```

ä¸€èˆ¬æƒ…å†µä¸‹ï¼ŒLiteFlowæœ‰è‡ªå·±é»˜è®¤çš„Idç”Ÿæˆè§„åˆ™ã€‚æ‰€ä»¥å¤§å¤šæ•°æƒ…å†µä¸‹ä½ å¹¶ä¸éœ€è¦å»ç‰¹åˆ«è‡ªå®šä¹‰è¿™ä¸ªIdç”Ÿæˆå™¨ã€‚

## ä¼ å…¥å·²æœ‰çš„requestId/traceId

LiteFlowåœ¨v2.10.5ç‰ˆæœ¬ä¸­å¯¹äºè¿™ä¸ªç‰¹æ€§ç»™äºˆäº†æ”¯æŒã€‚åœ¨FlowExecutorè¿›è¡Œè°ƒç”¨çš„æ—¶å€™ï¼Œä½ å¯ä»¥è°ƒç”¨å¦‚ä¸‹æ–¹æ³•æ¥ä¼ å…¥ä¸€ä¸ªå·²æœ‰çš„requestIdï¼š

```java
LiteflowResponse response = flowExecutor.execute2RespWithRid("chain1", arg, "T001234", YourContext.class);
```

é‚£ä¹ˆï¼Œè¿™ä¸ªé“¾è·¯ä¸­æ‰€æœ‰çš„æ¡†æ¶æ—¥å¿—å‰ï¼Œéƒ½ä¼šå¸¦æœ‰[T001234]è¿™ä¸ªä¼ å…¥çš„IDäº†ã€‚

## ç»™ç»„ä»¶ä¸­çš„æ—¥å¿—ä¹ŸåŠ ä¸Šè¯·æ±‚IDå‰ç¼€

å€¼å¾—ä¸€æçš„æ˜¯ï¼ŒLiteFlowè¿˜æä¾›äº†ä¸€ä¸ªæ—¥å¿—åŒ…è£…ç±»ã€‚åªè¦ä½ åœ¨ç»„ä»¶ä¸­æŠŠslf4jçš„æ—¥å¿—å£°æ˜æ¢æˆå¦‚ä¸‹å½¢å¼ï¼Œé‚£ä¹ˆä½ åœ¨ç»„ä»¶ä¸­è‡ªå·±æ‰“å‡ºçš„æ—¥å¿—ä¹Ÿä¼šå¸¦æœ‰è¯·æ±‚IDå‰ç¼€ã€‚

```java
private final LFLog logger = LFLoggerManager.getLogger(FlowExecutor.class);
```

å…¶ä¸­`LFLog`è¿™ä¸ªç±»æ˜¯ç»§æ‰¿è‡ªslf4jçš„`Logger`ç±»çš„ï¼Œæ‰€ä»¥å®ƒçš„ä½¿ç”¨æ–¹å¼å’Œ`Logger`æ˜¯å®Œå…¨ä¸€è‡´çš„ã€‚

ä½ åªéœ€è¦æŠŠå®šä¹‰æ¢ä¸€ä¸‹å°±okäº†ã€‚

å¦‚æœåœ¨ä¸€ä¸ªé“¾è·¯ä¸­ç›¸åŒè¯·æ±‚çš„æ—¥å¿—éƒ½æ‹¥æœ‰åŒä¸€ä¸ªè¯·æ±‚IDï¼Œé‚£ä¹ˆå¯¹äºå®šä½é—®é¢˜æ¥è¯´ï¼Œä¼šå¾ˆæ–¹ä¾¿ã€‚æ¨èå¤§å®¶ä½¿ç”¨æ­¤ç‰¹æ€§ã€‚

