---
title: ğŸ ç»„ä»¶å¼‚æ­¥å±‚é¢çš„çº¿ç¨‹æ± 
date: 2025-02-20 22:19:34
permalink: /pages/02b08a/
---

**ç‰ˆæœ¬æ”¯æŒï¼š**<Badge text="v2.13.0+" vertical="middle"/>

LiteFlowä¸­æœ‰å¾ˆå¤šç¼–æ’åœºæ™¯ï¼Œéƒ½æ¶‰åŠåˆ°äº†å¼‚æ­¥ã€‚åˆ†åˆ«ä¸ºï¼š

1.WHENåœºæ™¯

```xml
<chain id="chain1">
    WHEN(a, b, c);
</chain>
```

2.å¼‚æ­¥å¾ªç¯åœºæ™¯

 ``` xml
<chain name="chain1">
    FOR(2).parallel(true).DO(THEN(a,b,c));
</chain>
 ```
 ``` xml
<chain name="chain2">
    WHILE(x).parallel(true).DO(THEN(a,b,c));
</chain>
 ```
 ``` xml
<chain name="chain3">
    ITERATOR(x).parallel(true).DO(THEN(a,b,c));
</chain>
 ```

3.WHENçº¿ç¨‹æ± éš”ç¦»åœºæ™¯

å…³äºè¿™ä¸ªåŠŸèƒ½çš„ä»‹ç»è¯·å‚ç…§[å¼€å¯WHENçº¿ç¨‹æ± éš”ç¦»](/pages/b3446a/#%E5%BC%80%E5%90%AFwhen%E7%BA%BF%E7%A8%8B%E6%B1%A0%E9%9A%94%E7%A6%BB)ã€‚

```properties
liteflow.when-thread-pool-isolate=true
```

## å…¨å±€çº¿ç¨‹æ± 

é»˜è®¤æƒ…å†µä¸‹ï¼Œä»¥ä¸Šè¿™äº›åœºæ™¯éƒ½å…±ç”¨ä¸€ä¸ªçº¿ç¨‹æ± ï¼Œå³å…¨å±€çº¿ç¨‹æ± ã€‚å…¨å±€çº¿ç¨‹æ± æœ‰é»˜è®¤æä¾›å®ç°æ–¹å¼ï¼Œå¯ä»¥åœ¨é…ç½®é¡¹é‡Œè¿›è¡Œé…ç½®çº¿ç¨‹æ± å¤§å°å’Œé˜Ÿåˆ—å¤§å°ã€‚

```properties
#å…¨å±€å¼‚æ­¥èŠ‚ç‚¹çº¿ç¨‹æ± å¤§å°ï¼Œé»˜è®¤ä¸º64
liteflow.global-thread-pool-size: 64
#å…¨å±€å¼‚æ­¥èŠ‚ç‚¹çº¿ç¨‹æ± é˜Ÿåˆ—å¤§å°ï¼Œé»˜è®¤ä¸º512
liteflow.global-thread-pool-queue-size: 512
```

å½“ç„¶æ¡†æ¶ä¹Ÿæä¾›è‡ªå®šä¹‰çš„å…¨å±€çº¿ç¨‹æ± çš„å®ç°ï¼Œä½ éœ€è¦åœ¨é…ç½®é¡¹é‡Œçš„é…ç½®ï¼š

```properties
#å…¨å±€å¼‚æ­¥èŠ‚ç‚¹çº¿ç¨‹æ± è‡ªå®šä¹‰Builderï¼ŒLiteFlowæä¾›äº†é»˜è®¤çš„çº¿ç¨‹æ± Builder
liteflow.global-thread-pool-executor-class: com.yomahub.liteflow.thread.LiteFlowDefaultGlobalExecutorBuilder
```

ä½ å¯ä»¥æ›¿æ¢é»˜è®¤å®ç°ï¼Œè‡ªå·±å®ç°çš„çº¿ç¨‹æ± æä¾›ç±»éœ€è¦å®ç°`ExecutorBuilder`æ¥å£ï¼š

```java
public class CustomThreadBuilder implements ExecutorBuilder {
    @Override
    public ExecutorService buildExecutor() {
        ...
    }
}
```

å½“ç„¶ä½ å®šä¹‰äº†è‡ªå®šä¹‰çš„çº¿ç¨‹æ± å®ç°ç±»ï¼Œ`liteflow.global-thread-pool-size`å’Œ`liteflow.global-thread-pool-queue-size`å¤±æ•ˆã€‚

## Chainå±‚é¢çš„çº¿ç¨‹æ± 

å¦‚æœä½ ä¸æƒ³æ‰€æœ‰çš„éƒ½ç”¨åŒä¸€ä¸ªå…¨å±€çº¿ç¨‹æ± ï¼Œæƒ³ä¸ºæŸä¸ªchainå•ç‹¬å®šä¹‰çº¿ç¨‹æ± ï¼Œå°±éœ€è¦å¦‚ä¸‹å®šä¹‰ï¼š

```xml
<chain name="chain1" thread-pool-executor-class="com.yomahub.liteflow.test.chainThreadPool.CustomChainThreadExecutor">
    WHEN(a,b);
</chain>
```

å¦‚æœä½ è¿™æ ·å®šä¹‰äº†ï¼Œé‚£ä¹ˆè¿™ä¸ªchainå†…çš„æ‰€æœ‰å¼‚æ­¥åœºæ™¯ï¼Œéƒ½ä¼šèµ°ä½ å®šä¹‰çš„çº¿ç¨‹æ± ã€‚

åŒæ ·çš„ï¼Œè¿™ä¸ªè‡ªå®šä¹‰çš„çº¿ç¨‹æ± æä¾›ç±»éœ€è¦ä½ æ¥å®ç°ï¼š

```java
public class CustomChainThreadExecutor implements ExecutorBuilder {
    @Override
    public ExecutorService buildExecutor() {
        ...
    }
}
```

## è¡¨è¾¾å¼å±‚é¢çš„çº¿ç¨‹æ± 

å¦‚æœä½ è¿˜æƒ³æ›´ç»†åŒ–ç‚¹æ¥å®šä¹‰ä½ çš„çº¿ç¨‹æ± ï¼ŒLiteFlowè¿˜æ”¯æŒè¡¨è¾¾å¼å±‚é¢çš„çº¿ç¨‹æ± è‡ªå®šä¹‰å…³é”®å­—:

```xml
<chain name="chain1">
    WHEN(c, d).threadPool("com.yomahub.liteflow.test.customWhenThreadPool.CustomThreadExecutor");
</chain>
```

ä¹Ÿå¯ä»¥ç”¨äºå¼‚æ­¥å¾ªç¯åœºæ™¯ï¼š
 ``` xml
<chain name="chain1">
    FOR(2).parallel(true).DO(THEN(a,b,c)).threadPool("com.yomahub.liteflow.test.customWhenThreadPool.CustomThreadExecutor");
</chain>
 ```
 ``` xml
<chain name="chain2">
    WHILE(x).parallel(true).DO(THEN(a,b,c)).threadPool("com.yomahub.liteflow.test.customWhenThreadPool.CustomThreadExecutor");
</chain>
 ```
 ``` xml
<chain name="chain3">
    ITERATOR(x).parallel(true).DO(THEN(a,b,c)).threadPool("com.yomahub.liteflow.test.customWhenThreadPool.CustomThreadExecutor");
</chain>
 ```

å½“ç„¶è¿™é‡Œå¾ªç¯å¿…é¡»è¦ä¸ºå¼‚æ­¥`parallel(true)`ï¼Œå¦‚æœä¸æ˜¯å¼‚æ­¥çš„ï¼Œé‚£ä¹ˆ`threadPool`å³ä½¿åŠ äº†ä¹Ÿæ²¡ä»»ä½•æ„ä¹‰ã€‚

åŒæ ·çš„ï¼Œè¿™ä¸ªè‡ªå®šä¹‰çš„çº¿ç¨‹æ± æä¾›ç±»éœ€è¦ä½ æ¥å®ç°ï¼š

```java
public class CustomThreadExecutor implements ExecutorBuilder {
    @Override
    public ExecutorService buildExecutor() {
        ...
    }
}
```

## å„ä¸ªç»´åº¦çº¿ç¨‹æ± çš„ä¼˜å…ˆçº§

å¦‚æœå…¨å±€çº¿ç¨‹æ± ï¼ŒChainå±‚é¢çº¿ç¨‹æ± ï¼Œè¡¨è¾¾å¼å±‚é¢çº¿ç¨‹æ± å…±å­˜ï¼Œä¼˜å…ˆçº§é¡ºåºä¾æ¬¡ä¸ºï¼š

è¡¨è¾¾å¼å±‚é¢çº¿ç¨‹æ±  > Chainå±‚é¢çº¿ç¨‹æ±  > å…¨å±€çº¿ç¨‹æ± 


