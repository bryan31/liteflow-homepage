---
title: ğŸŒ°æ„é€ EL
date: 2023-10-11 21:54:09
permalink: /pages/a3cb4b/
---

## ä¾èµ–

ä»2.11.1ç‰ˆæœ¬å¼€å§‹ï¼Œä½ å¯ä»¥åœ¨ä»£ç ä¸­åŠ¨æ€ç»„è£…ELè¡¨è¾¾å¼ï¼ŒåŒ…æ‹¬åˆ›å»ºã€ä¿®æ”¹ã€è¾“å‡ºELè¡¨è¾¾å¼ã€‚

å¦‚æœéœ€è¦åœ¨ä»£ç ä¸­åŠ¨æ€æ„å»ºELè¡¨è¾¾å¼ï¼Œéœ€è¦æ·»åŠ ä»¥ä¸‹é¢å¤–ä¾èµ–ï¼š
```xml
<dependency>
    <groupId>com.yomahub</groupId>
    <artifactId>liteflow-el-builder</artifactId>
    <version>2.13.1</version>
</dependency>
```

## åŸºæœ¬ç”¨æ³•

ä½ å¯ä»¥é€šè¿‡å·¥å‚ç±»ELBusåˆ›å»ºä»»ä½•ä¸€ä¸ªELè¡¨è¾¾å¼ã€‚æ¯”å¦‚å¯¹äºè¿™æ ·ä¸€ä¸ªELè¡¨è¾¾å¼ï¼š


:::tip å›¾ç¤º

<img :src="$withBase('/img/flow_example/e3.svg')" style="zoom: 80%" class="no-zoom">

:::


å¯ä»¥è°ƒç”¨å¦‚ä¸‹æ–¹æ³•ç»„è£…è¯¥è¡¨è¾¾å¼ï¼š

```Java
// ç»„è£…ELè¡¨è¾¾å¼
ThenELWrapper el = ELBus.then(
        "a",
		ELBus.when("b", ELBus.then("c", "d")),
		"e");
System.out.println(el.toEL());
```

å¯ä»¥è°ƒç”¨`toEL()`æ–¹æ³•è¾“å‡ºELè¡¨è¾¾å¼ï¼š

```
THEN(a,WHEN(b,THEN(c,d)),e)
```

## åœ¨è¡¨è¾¾å¼ä¸Šè®¾ç½®å­å…³é”®å­—

ä½ å¯ä»¥åœ¨ç›¸åº”çš„åœ°æ–¹è°ƒç”¨å­å…³é”®å­—ï¼Œæ¯”å¦‚`id`,`tag`,`bind`,`any`ç­‰ç­‰ï¼Œä¸‹é¢æ˜¯å‡ ä¸ªä¾‹å­

```java
String el = ELBus.switchOpt("x").to(ELBus.when("a,b").id("x1"), "c").toEL();
System.out.println(el);
//è¾“å‡ºï¼šSWITCH(x).TO(WHEN(a,b).id("x1"),c);
```

```java
String el = ELBus.then(ELBus.when("a", "b").any(true), "c").bind("k1","v1").toEL();
System.out.println(el);
//è¾“å‡ºï¼šTHEN(WHEN(a,b).any(true),c).bind("k1", "v1");
```

## åœ¨èŠ‚ç‚¹ä¸Šè®¾ç½®å­å…³é”®å­—

ä»¥ä¸Šéƒ½æ˜¯åœ¨è¡¨è¾¾å¼å±‚é¢è®¾ç½®å…³é”®å­—ï¼Œå¯èƒ½ä¼šæœ‰äººç–‘é—®ï¼Œå¦‚æœæˆ‘è¦åœ¨èŠ‚ç‚¹ä¸Šè®¾ç½®`data`,`tag`,`bind`æ€ä¹ˆåŠå‘¢ã€‚

è¿™é‡Œä½ éœ€è¦ç”¨åˆ°`ELBus.element("a")`æˆ–æ˜¯`ELBus.node("a")`ã€‚è¿™ä¸¤è€…çš„æ•ˆæœåˆ†åˆ«å¦‚ä¸‹ï¼š

```java
String el = ELBus.then(ELBus.element("a").tag("t1"), ELBus.element("b").bind("k1", "v1")).toEL();
System.out.println(el);
//è¾“å‡ºï¼šTHEN(a.tag("t1"),b.bind("k1", "v1"));
```

```java
String el = ELBus.then(ELBus.node("a").tag("t1"), ELBus.node("b").bind("k1", "v1")).toEL();
System.out.println(el);
//è¾“å‡ºï¼šTHEN(node("a").tag("t1"),node("b").bind("k1", "v1"));
```

å¯ä»¥çœ‹åˆ°ï¼Œå…¶å®`ELBus.then("a")`å’Œ`ELBus.then(ELBus.element("a")`æ˜¯ç­‰ä»·çš„ï¼Œä¸åŒçš„æ˜¯åè€…æ˜¯å¯ä»¥è®¾ç½®å­å…³é”®å­—çš„ã€‚

è€Œ`ELBus.node("a")`åˆ™æ˜¯ç»™èŠ‚ç‚¹å¤–é¢å¥—ä¸Šäº†`node`å…³é”®å­—ï¼Œå…¶æ„ä¹‰æ˜¯åœ¨åŠ è½½çš„æ—¶å€™ä¸æ£€æŸ¥å’Œé™çº§ï¼Œå…³äº`node`å…³é”®å­—çš„è¯¦ç»†å¯å‚è€ƒ[ç»„ä»¶ååŒ…è£…](/pages/2df3d9/)ä»¥åŠ[ç»„ä»¶é™çº§](/pages/79289a/)ã€‚

:::tip
å…¶å®ç”¨javaå»æ„é€ ELè¡¨è¾¾å¼çš„æ€è·¯å’Œä¹¦å†™è¡¨è¾¾å¼çš„æ€è·¯æ˜¯ä¸€æ ·çš„ã€‚å…¶ç»“æ„å‡ ä¹æ˜¯å®Œå…¨ä¸€æ ·çš„ã€‚è¿™ä¸ªç›¸ä¿¡å¼€å‘è€…å¤šåŠ ä»¥è¯•è¯•å°±èƒ½ä¸¾ä¸€åä¸‰ã€‚

è¿™é‡Œåªæ˜¯é’ˆå¯¹å‡ ç§æƒ…å†µåšä¸€äº›ä»‹ç»ï¼Œä¸ä¼šä¸€ä¸€ä»‹ç»æ¯ä¸ªæ–¹æ³•ã€‚
:::

## æ ¼å¼åŒ–è¾“å‡ºELè¡¨è¾¾å¼

å®¹æ˜“èƒ½å‘ç°`toEL()`æ–¹æ³•è¾“å‡ºçš„ELè¡¨è¾¾å¼æ˜¯ä¸€è¡Œå­—ç¬¦ä¸²ï¼Œä¸æ–¹ä¾¿æŸ¥çœ‹ä»¥åŠæ ¡éªŒELè¡¨è¾¾å¼æ˜¯å¦æ­£ç¡®ã€‚å¯ä»¥ä½¿ç”¨ `toEL(true)` æ–¹æ³•ä»¥æ ‘å½¢ç»“æ„è¾“å‡ºELè¡¨è¾¾å¼ï¼Œä»¥ä¸‹æ˜¯ä¸€ä¸ªä¾‹å­ï¼š

```java
// ELè¡¨è¾¾å¼ç»„è£…
WhenELWrapper el = ELBus.when("a",
		ELBus.when(ELBus.node("b").data("whenData", "{\"name\":\"zhangsan\",\"age\":18}"))
		     .when("c")
			 .id("this is a id"),
		"d").tag("this is a tag").any(true);
System.out.println(el.toEL(true));
```
è¾“å‡ºå¾—åˆ°ï¼š

```
whenData = '{"name":"zhangsan","age":18}';
WHEN(
	node("a"),
	WHEN(
		node("b").data(whenData),
		node("c")
	).id("this is a id"),
	node("d")
).any(true).tag("this is a tag")
```

## ç›®å‰æ”¯æŒçš„è¡¨è¾¾å¼å’Œå…³é”®å­—

ç›®å‰æ”¯æŒåˆ°2.13.0ç‰ˆæœ¬çš„æ‰€æœ‰ELè¡¨è¾¾å¼ï¼ŒåŒ…æ‹¬å…¶ä¸­çš„å…³é”®å­—å’Œé«˜çº§ç‰¹æ€§ã€‚å½“å‰æ”¯æŒçš„è¯¦ç»†å†…å®¹å¦‚ä¸‹è¡¨ï¼š

| ELè¡¨è¾¾å¼       | åˆ›å»ºæ–¹æ³•                                                | æ”¯æŒè°ƒç”¨æ–¹æ³•                                                 | æ”¯æŒå…³é”®å­—                                                   |
| -------------- | ------------------------------------------------------- | ------------------------------------------------------------ | ------------------------------------------------------------ |
| ä¸²è¡Œç¼–æ’       | ELBus.then                                              | then(Object ... objects)                                     | pre<br />finally<br />tag<br />id<br />maxWaitSeconds<br />data<br />bind |
| å¹¶è¡Œç¼–æ’       | ELBus.when                                              | when(Object ... objects)                                     | any<br />ignoreError<br />customThreadExecutor<br />must<br />tag<br />id<br />maxWaitSeconds<br />data<br />bind |
| é€‰æ‹©ç¼–æ’       | ELBus.switch                                            | to(Object... objects)<br />defaultOpt(Object object)         | tag<br />id<br />maxWaitSeconds<br />data<br />bind          |
| æ¡ä»¶ç¼–æ’       | ELBus.ifOpt                                             | elseOpt(Object falseObject)<br />elIfOpt(Object ifObject, Object trueObject) | tag<br />id<br />maxWaitSeconds<br />data<br />bind          |
| å¾ªç¯ç¼–æ’       | ELBus.forOpt<br />ELBus.whileOpt<br />ELBus.iteratorOpt | doOpt(Object object)<br />breakOpt(Object object) (ITERATORè¿­ä»£å™¨å¾ªç¯è¡¨è¾¾å¼ä¸æ”¯æŒ) | parallel<br />tag<br />id<br />maxWaitSeconds                |
| æ•è·å¼‚å¸¸è¡¨è¾¾å¼ | ELBus.catchException                                    | doOpt(Object object)                                         | tag<br />id<br />maxWaitSeconds                              |
| ä¸è¡¨è¾¾å¼       | ELBus.and                                               | and(Object ... object)                                       | tag<br />id<br />maxWaitSeconds<br />data<br />bind          |
| æˆ–è¡¨è¾¾å¼       | ELBus.or                                                | or(Object ... object)                                        | tag<br />id<br />maxWaitSeconds                              |
| éè¡¨è¾¾å¼       | ELBus.not                                               |                                                              | tag<br />id<br />maxWaitSeconds<br />data<br />bind          |
| å•èŠ‚ç‚¹è¡¨è¾¾å¼   | ELBus.node                                              |                                                              | tag<br />data<br />maxWaitSeconds<br />data<br />bind        |
| å‰ç½®ç»„ä»¶       | é€šè¿‡thenç»„ä»¶çš„preå…³é”®å­—åˆ›å»º                             |                                                              | tag<br />id<br />maxWaitSeconds<br />data<br />bind          |
| åç½®ç»„ä»¶       | é€šè¿‡thenç»„ä»¶çš„finallyå…³é”®å­—åˆ›å»º                         |                                                              | tag<br />id<br />data<br />bind                              |

## ELè¡¨è¾¾å¼å‚æ•°æ ¡éªŒ

ç»„è£…è¡¨è¾¾å¼æ—¶ä¼šå¯¹è¡¨è¾¾å¼çš„å‚æ•°ç±»å‹è¿›è¡Œæ ¡éªŒã€‚åŒ…æ‹¬æ˜¯å¦ä¸ºå•èŠ‚ç‚¹ç»„ä»¶ã€æ˜¯å¦å…è®¸ä¸ºä¸æˆ–éè¡¨è¾¾å¼ç­‰ã€‚æ¯”å¦‚ï¼ŒWHILEè¡¨è¾¾å¼`WHILE(w).DO(THEN(a, b));` ä¸­ï¼Œwéœ€è¦æ˜¯è¿”å›å¸ƒå°”å€¼çš„èŠ‚ç‚¹æˆ–ä¸æˆ–éè¡¨è¾¾å¼ã€‚

æ›´å¤šæµ‹è¯•æ ·ä¾‹è¯·åœ¨ `liteflow-testcase-el/liteflow-testcase-el-builder` æ¨¡å—ä¸­æŸ¥çœ‹ã€‚