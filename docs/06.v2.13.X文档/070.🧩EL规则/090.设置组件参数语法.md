---
title: ğŸ‰è®¾ç½®ç»„ä»¶å‚æ•°è¯­æ³•
date: 2022-10-06 22:55:30
permalink: /pages/6e4d15/
---

ç»„ä»¶å‚æ•°æ˜¯æŒ‡ç»™ç»„ä»¶ç¼–æ’ä¸­è®¾ç½®ç‰¹å®šçš„å‚æ•°ã€‚è¿™äº›å‚æ•°èƒ½åœ¨ç»„ä»¶ä¸­èƒ½è¢«è½»æ˜“å–å‡ºæ¥å‚ä¸é€»è¾‘è¿ç®—ã€‚

LiteFlowèƒ½ç»™ç»„ä»¶è®¾ç½®å‚æ•°çš„å…³é”®æœ‰ä¸‰ä¸ªï¼Œåˆ†åˆ«ä¸º`tag`,`data`å’Œ`bind`ï¼Œå®ƒä»¬åšçš„äº‹éƒ½æ˜¯è®¾ç½®å‚æ•°ï¼Œä½†æ˜¯åœ¨å„è‡ªçš„åœºæ™¯ä¸Šåˆç•¥å¾®æœ‰ä¸åŒã€‚ä»¥ä¸‹ç¯‡å¹…ä¼šåˆ†åˆ«ä»‹ç»ã€‚

## tagè¯­æ³•çš„ç”¨æ³•

`tag`æœ‰2ç§ç”¨é€”ï¼š

* ç”¨äº`SWITCH`è¯­æ³•çš„é€‰æ‹©
* èµ‹å€¼

å…³äº`SWITCH`çš„é€‰æ‹©`tag`æ ‡ç­¾å†…å®¹è¯·å‚è€ƒ[é€‰æ‹©ç¼–æ’](/pages/d90483/)è¿™ä¸€ç« ã€‚

è¿™ç« ä¸»è¦é˜è¿°`tag`æ ‡ç­¾çš„èµ‹å€¼åŠŸèƒ½ã€‚

ä½ å¯ä»¥åœ¨è§„åˆ™è¡¨è¾¾å¼é‡Œç»™æ¯ä¸ªç»„ä»¶æ·»åŠ è¿è¡Œæ—¶çš„æ ‡ç­¾å€¼ï¼Œç”¨`tag`å…³é”®å­—è¡¨ç¤ºï¼š

```xml
<chain name="chain1">
    THEN(
        a.tag("tag1"),
        b.tag("tag2"),
        c.tag("tag3")
    );
</chain>
```

è¿™æ ·ï¼Œä½ åœ¨ä»£ç é‡Œå¯ä»¥é€šè¿‡`this.getTag()`è·å–åˆ°å½“å‰çš„æ ‡ç­¾ï¼Œè¿™åœ¨æœ‰äº›æ—¶å€™éå¸¸æœ‰ç”¨ï¼Œå°¤å…¶æ˜¯å½“å¤šä¸ªç›¸åŒç»„ä»¶ç¼–æ’æ—¶ï¼Œä½ å¯ä»¥æ ¹æ®`tag`æ¥è·çŸ¥åˆ°ä¸åŒçš„å‚æ•°ã€‚æˆ–è€…æ ¹æ®tagæ ‡ç­¾æ¥ç»™ç›¸åŒçš„ç»„ä»¶ä½œä¸åŒçš„åˆ¤æ–­ã€‚

```java
@LiteflowComponent("b")
public class BCmp extends NodeComponent {
    @Override
    public void process() {
        String tag = this.getTag();
        ...
    }
}
```

å½“ç„¶ï¼Œä»¥ä¸‹è¿™ç§ä¾‹å­ä¹Ÿæ˜¯å¯ä»¥çš„:

```xml
<chain name="chain1">
    THEN(
        a.tag("1"), a.tag("2"), a.tag("3"), a.tag("4"), a.tag("5"), a.tag("6")
    );
</chain>
```

## dataè¯­æ³•çš„ç”¨æ³•<Badge text="v2.9.0+"/>

ä½ å¯ä»¥åœ¨ELè¯­æ³•ä¸­é€šè¿‡`data`æ¥ç»™ç»„ä»¶è®¾ç½®å¤–ç½®å‚æ•°ï¼Œå»ºè®®æœ€å¥½æ˜¯JSONæ ¼å¼ï¼š

```xml
<flow>
    <chain name="chain1">
        cmpData = '{"name":"jack","age":27,"birth":"1995-10-01"}';
    
        THEN(a, b.data(cmpData), c);
    </chain>
    
    <chain name="chain2">
        cmpData = '{"name":"rose","age":20,"birth":"1997-07-01"}';
    
        WHEN(c, b.data(cmpData));
    </chain>
</flow>
```

ä¸Šè¿°è¡¨è¾¾å¼ä¸­ï¼ŒåŒä¸€ä¸ªbç»„ä»¶ï¼Œåœ¨ä¸åŒçš„chainä¸­è¢«èµ‹äºˆäº†ä¸åŒçš„å¤–ç½®å‚æ•°ï¼Œè¿è¡Œä¸­åœ¨ç»„ä»¶ä¸­é€šè¿‡`this.getCmpData`æ–¹æ³•ä¹Ÿèƒ½æ‹¿åˆ°ç›¸åº”çš„å‚æ•°ã€‚

å¦‚æœä¸Šè¿°å¯¹è±¡æ˜¯ä¸€ä¸ªJsonçš„æ•°ç»„ï¼Œåœ¨ç»„ä»¶ä¸­ä¹Ÿå¯ä»¥é€šè¿‡`getCmpDataList`æ–¹æ³•æ¥è·å–ã€‚

è¿™ä¸ªæ–¹æ³•æ˜¯å¯ä»¥è¿”å›å¯¹åº”ç»“æ„çš„javaå¯¹è±¡çš„ï¼Œåªè¦ä¼ å…¥ç›¸å¯¹åº”çš„classå³å¯ã€‚

```java
@LiteflowComponent("b")
public class BCmp extends NodeComponent {

	@Override
	public void process() {
		User user = this.getCmpData(User.class);
		...
	}

}
```

è¦æ³¨æ„çš„æ˜¯ï¼Œ`data`å…³é”®å­—ä¹Ÿå¯ä»¥ç”¨ä½œäºè¡¨è¾¾å¼ï¼Œå­å˜é‡ï¼Œchainä¸Šï¼Œå…¶æ„ä¹‰æ˜¯è¢«èµ‹å€¼çš„è¡¨è¾¾å¼/å­å˜é‡/chainé‡Œæ‰€æœ‰çš„ç»„ä»¶éƒ½è®¾ç½®äº†ç›¸åŒçš„å€¼ï¼Œæ¯”å¦‚ï¼š

```xml
<chain name="chain1">
    THEN(a, b, c).data("123");
</chain>
```

```xml
<chain name="chain1">
    sub = WHEN(b, c);
    THEN(a, sub.data(""))
</chain>
```

```xml
<chain name="chain1">
    THEN(a, b, c);
</chain>

<chain name="chain2">
    WHEN(x, y, chain1.data("123"));
</chain>
```

## bindè¯­æ³•çš„ç”¨æ³•<Badge text="v2.13.0+"/>

LiteFlowè¿˜æä¾›äº†`bind`è¯­æ³•å…³é”®å­—ï¼Œå®ƒå’Œ`data`ä½¿ç”¨åœºæ™¯æ˜¯ä¸€è‡´çš„ï¼Œä½†æ˜¯å®ƒå’Œ`data`å…³é”®ä¸åŒçš„æ˜¯ï¼Œå®ƒå…è®¸ç»‘å®šKVé”®å€¼å¯¹ï¼Œæ¯”å¦‚

```xml
<chain id="chain1">
    THEN(a.bind("k1", "test"), b);
</chain>
```

ä½ å¯ä»¥åœ¨ç»„ä»¶ä¸­é€šè¿‡`getBindData`æ–¹æ³•æ¥è·å–ï¼š

```java
@LiteflowComponent("a")
public class ACmp extends NodeComponent {
	@Override
	public void process() {
		String bindValue = this.getBindData("k1", String.class);
		...
	}
}
```

å½“ç„¶bindçš„æ—¶å€™ä¹Ÿå¯ä»¥æŠŠvalueè®¾ç½®æˆjsonå­—ç¬¦ä¸²ï¼Œé‚£ä¹ˆåœ¨å–å€¼çš„æ—¶å€™ï¼Œç¬¬äºŒä¸ªå‚æ•°å°±å¯ä»¥ä¼ ç›¸åº”çš„VOçš„classï¼ŒLiteFlowå†…éƒ¨å¯ä»¥è‡ªåŠ¨æŠŠJsonè½¬å‹æˆå¯¹è±¡ã€‚

`bind`å…³é”®å­—ä¹Ÿå¯ä»¥ç”¨ä½œäºè¡¨è¾¾å¼ï¼Œå­å˜é‡ï¼Œchainä¸Šï¼Œå…¶æ„ä¹‰æ˜¯è¢«èµ‹å€¼çš„è¡¨è¾¾å¼/å­å˜é‡/chainé‡Œæ‰€æœ‰çš„ç»„ä»¶éƒ½ç»‘å®šäº†ç›¸åŒçš„å€¼ï¼Œæ¯”å¦‚ï¼š

```xml
<chain id="chain1">
    THEN(a,b).bind("k1","test");
</chain>

<chain id="chain2">
    THEN(SWITCH(y).TO(d,c), WHEN(a, b), IF(x, c, d)).bind("k1", "test")
</chain>

<chain id="sub">
    THEN(a,IF(NOT(x), b, c));
</chain>

<chain id="chain3">
    THEN(d, sub.bind("k1", "test2"))
</chain>
```



