---
title: ğŸ§…ç±»çº§åˆ«å¼å£°æ˜
date: 2022-10-05 23:22:17
permalink: /pages/v2.11.X/18f548/
---

ç±»çº§åˆ«å¼å£°æ˜ä¸»è¦ç”¨å¤„å°±æ˜¯é€šè¿‡æ³¨è§£å½¢å¼è®©æ™®é€šçš„java beanå˜æˆLiteFlowçš„ç»„ä»¶ã€‚æ— éœ€é€šè¿‡ç»§æ‰¿ç±»æˆ–è€…å®ç°æ¥å£çš„æ–¹å¼ã€‚

ç”±äºLiteFlowçš„ç»„ä»¶å¸¸è§„æ–¹å¼ä¸‹éœ€è¦ç»§æ‰¿ç±»æ¥å®šä¹‰ï¼Œä½¿å¾—ä½ æ— æ³•å†ç»§æ‰¿è‡ªå·±ä¸šåŠ¡çš„ç±»äº†ã€‚è¿™ä¸ªç‰¹æ€§å¯ä»¥è§£å†³è¿™ä¸ªé—®é¢˜ã€‚ä½†æ˜¯å’Œå¸¸è§„ç»„ä»¶ä¸€æ ·ï¼Œéœ€è¦ä¸€ä¸ªç±»å¯¹åº”ä¸€ä¸ªç»„ä»¶ã€‚

## æ™®é€šç»„ä»¶çš„å£°æ˜

ä½ å¯ä»¥å¦‚ä¸‹å»è¿›è¡Œä¸€ä¸ªæ™®é€šç»„ä»¶çš„å£°æ˜ï¼š

```java
@LiteflowComponent("a")
@LiteflowCmpDefine
public class ACmp{
  
	@LiteflowMethod(LiteFlowMethodEnum.PROCESS)
	public void processAcmp(NodeComponent bindCmp) {
		System.out.println("ACmp executed!");
	}

	@LiteflowMethod(LiteFlowMethodEnum.IS_ACCESS)
	public boolean isAcmpAccess(NodeComponent bindCmp){
		return true;
	}

	@LiteflowMethod(LiteFlowMethodEnum.BEFORE_PROCESS)
	public void beforeAcmp(NodeComponent bindCmp){
		System.out.println("before A");
	}

	@LiteflowMethod(LiteFlowMethodEnum.AFTER_PROCESS)
	public void afterAcmp(NodeComponent bindCmp){
		System.out.println("after A");
	}

	@LiteflowMethod(LiteFlowMethodEnum.ON_SUCCESS)
	public void onAcmpSuccess(NodeComponent bindCmp){
		System.out.println("Acmp success");
	}

	@LiteflowMethod(LiteFlowMethodEnum.ON_ERROR)
	public void onAcmpError(NodeComponent bindCmp, Exception e){
		System.out.println("Acmp error");
	}
	
	@LiteflowMethod(LiteFlowMethodEnum.IS_END)
	public boolean isAcmpEnd(NodeComponent bindCmp) {
		return false;
	}
    
    @LiteflowMethod(value = LiteFlowMethodEnum.ROLLBACK)
    public void rollbackA(NodeComponent bindCmp) throws Exception {
        System.out.println("ACmp rollback!");
    }
}
```

ä½¿ç”¨è€…æ— éœ€ç»§æ‰¿`NodeComponent`äº†ï¼Œåœ¨ä½ å®šä¹‰çš„ç±»ä¸Šï¼Œåªè¦ç±»ä¸ŠåŠ ä¸Š`LiteflowCmpDefine`æ³¨è§£ï¼Œç›¸åº”çš„æ–¹æ³•ä¸ŠåŠ ä¸Š`LiteflowMethod`æ³¨è§£ï¼Œå³å¯å®Œæˆå¯¹ä»»æ„è‡ªå®šä¹‰ç±»çš„ç»„ä»¶åŒ–å·¥ä½œã€‚

å…¶ä¸­`LiteFlowMethod`çš„ä½œç”¨æ˜¯æŠŠä½ è‡ªå·±çš„å®šä¹‰çš„æ–¹æ³•æ˜ å°„æˆç»„ä»¶çš„æ–¹æ³•ã€‚é™¤äº†æœ‰ç¤ºä¾‹ä¸Šçš„å€¼å¤–ï¼Œè¿˜æœ‰å…¶ä»–çš„æ˜ å°„æ–¹æ³•ã€‚å…·ä½“å¯ä»¥çœ‹ä¸‹[æ™®é€šç»„ä»¶](/pages/v2.11.X/8486fb/)ç« èŠ‚ã€‚


::: tip æ³¨æ„ç‚¹1

å…³äºå‚æ•°çš„å‚æ•°ï¼Œè¿™é‡Œéœ€è¦æ³¨æ„çš„æ˜¯ï¼Œæ–¹æ³•ä¸Šå‚æ•°å¿…é¡»ä¼ å…¥`NodeComponent bindCmp`è¿™ä¸ªå‚æ•°ï¼Œè€Œä¸”å¿…é¡»æ˜¯ç¬¬ä¸€ä¸ªå‚æ•°ã€‚

æ¯”å¦‚åŸå…ˆçš„`process()`ï¼Œé‚£ä¹ˆåœ¨å£°æ˜å¼é‡Œå°±æ˜¯`yourMethodName(NodeComponent bindCmp)`ã€‚

å¦‚æœæ˜¯åŸå…ˆçš„`onError(Exception e)`ï¼Œé‚£ä¹ˆåœ¨å£°æ˜å¼é‡Œå°±æ˜¯`yourMethodName(NodeComponent bindCmp, Exception e)`ã€‚

è§„å¾‹å¾ˆæ˜æ˜¾ï¼Œå°±æ˜¯åŸå…ˆçš„å‚æ•°ä¿ç•™ï¼Œåœ¨ç¬¬ä¸€ä¸ªä½ç½®æ’å…¥`NodeComponent`å¯¹è±¡ï¼Œä»£æ›¿åŸå…ˆçš„`this`ã€‚

ä»¥å‰è·å–ä¸Šä¸‹æ–‡Beanæ˜¯ç”¨`this`å…³é”®å­—ï¼Œç°åœ¨åªéœ€ä»bindCmpä¸­è·å–å°±å¯ä»¥äº†ã€‚

æ–¹æ³•çš„åç§°å¯ä»¥å®šä¹‰æˆä½ æƒ³è¦çš„ä»»ä½•æ–¹å¼ã€‚è¿™ä¸ªå¹¶æ— é™åˆ¶ã€‚

:::

::: tip æ³¨æ„ç‚¹2
è‡ªå·±å®šä¹‰æ–¹æ³•æ—¶ï¼Œè¿”å›å€¼è¦å’Œå¸¸è§„ç»„ä»¶é‡Œçš„å¯¹åº”æ–¹æ³•è¿”å›å€¼ä¸€è‡´ã€‚æ¯”å¦‚æ™®é€šç»„ä»¶çš„`process`æ–¹æ³•æ˜¯ä¸è¿”å›çš„ï¼Œæ¯”å¦‚IFç»„ä»¶çš„`processIf`æ–¹æ³•æ˜¯è¿”å›å¸ƒå°”å€¼çš„ã€‚

å¦‚æœå†™é”™ï¼Œä¹Ÿä¼šå‘ç”Ÿä¸€ç‚¹å¼‚å¸¸ï¼Œå¯èƒ½ä¼šå¢åŠ ä½ çš„æ’æŸ¥æ—¶é—´ã€‚
:::

## é€‰æ‹©ç»„ä»¶çš„å£°æ˜

å£°æ˜é€‰æ‹©ç»„ä»¶åœ¨ç±»å’Œæ–¹æ³•ä¸Šéƒ½éœ€è¦åŠ ä¸Š`NodeTypeEnum.SWITCH`å‚æ•°ã€‚

```java
@Component("e")
@LiteflowCmpDefine(NodeTypeEnum.SWITCH)
public class ECmp{

    @LiteflowMethod(value = LiteFlowMethodEnum.PROCESS_SWITCH, nodeType = NodeTypeEnum.SWITCH)
    public String processSwitch(NodeComponent bindCmp) throws Exception {
        System.out.println("Ecomp executed!");
        return "g";
    }
}
```

## æ¡ä»¶ç»„ä»¶çš„å£°æ˜

å£°æ˜é€‰æ‹©ç»„ä»¶åœ¨ç±»å’Œæ–¹æ³•ä¸Šéƒ½éœ€è¦åŠ ä¸Š`NodeTypeEnum.IF`å‚æ•°ã€‚

```java
@Component("x")
@LiteflowCmpDefine(NodeTypeEnum.IF)
public class XCmp{

	@LiteflowMethod(value = LiteFlowMethodEnum.IF, nodeType = NodeTypeEnum.IF)
	public boolean processIf(NodeComponent bindCmp) throws Exception {
		//do your biz
		return true;
	}
}
```

## æ•°å€¼å¾ªç¯ç»„ä»¶çš„å£°æ˜

å£°æ˜é€‰æ‹©ç»„ä»¶åœ¨ç±»å’Œæ–¹æ³•ä¸Šéƒ½éœ€è¦åŠ ä¸Š`NodeTypeEnum.FOR`å‚æ•°ã€‚

```java
@Component("x")
@LiteflowCmpDefine(NodeTypeEnum.FOR)
public class XCmp{

	@LiteflowMethod(value = LiteFlowMethodEnum.PROCESS_FOR, nodeType = NodeTypeEnum.FOR)
	public int processFor(NodeComponent bindCmp) throws Exception {
		//do your biz
		return 10;
	}
}
```

## æ¡ä»¶å¾ªç¯ç»„ä»¶çš„å£°æ˜

å£°æ˜é€‰æ‹©ç»„ä»¶åœ¨ç±»å’Œæ–¹æ³•ä¸Šéƒ½éœ€è¦åŠ ä¸Š`NodeTypeEnum.WHILE`å‚æ•°ã€‚

```java
@Component("x")
@LiteflowCmpDefine(NodeTypeEnum.WHILE)
public class XCmp{

	@LiteflowMethod(value = LiteFlowMethodEnum.PROCESS_WHILE, nodeType = NodeTypeEnum.WHILE)
	public boolean processWhile(NodeComponent bindCmp) throws Exception {
		//get your while flag
		boolean flag = xxxxxx;
		return flag;
	}
}
```

## é€€å‡ºå¾ªç¯ç»„ä»¶çš„å£°æ˜

å£°æ˜é€‰æ‹©ç»„ä»¶åœ¨ç±»å’Œæ–¹æ³•ä¸Šéƒ½éœ€è¦åŠ ä¸Š`NodeTypeEnum.BREAK`å‚æ•°ã€‚

```java
@Component("x")
@LiteflowCmpDefine(NodeTypeEnum.BREAK)
public class XCmp{

	@LiteflowMethod(value = LiteFlowMethodEnum.PROCESS_BREAK, nodeType = NodeTypeEnum.BREAK)
	public boolean processBreak(NodeComponent bindCmp) throws Exception {
		//get your break flag
		boolean flag = xxxxxx;
		return flag;
	}
}
```

## æ³¨æ„ç‚¹

::: tip
å¯¹äºç±»é‡Œçš„å…¶ä»–æ–¹æ³•ï¼Œä¹Ÿéƒ½å’Œ`processXxx`ä¸€æ ·çš„æ–¹å¼å»å£°æ˜ã€‚
:::
