(window.webpackJsonp=window.webpackJsonp||[]).push([[668],{1130:function(t,a,s){"use strict";s.r(a);var n=s(8),e=Object(n.a)({},(function(){var t=this,a=t._self._c;return a("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[a("h2",{attrs:{id:"组件的定义"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#组件的定义"}},[t._v("#")]),t._v(" 组件的定义")]),t._v(" "),a("p",[t._v("在依赖了以上jar包后。\n你需要定义并实现一些组件，确保SpringBoot会扫描到这些组件并注册进上下文")]),t._v(" "),a("div",{staticClass:"language-java extra-class"},[a("pre",{pre:!0,attrs:{class:"language-java"}},[a("code",[a("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[t._v("@Component")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"a"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("public")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("class")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("ACmp")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("extends")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("NodeComponent")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n\n\t"),a("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[t._v("@Override")]),t._v("\n\t"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("public")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("void")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("process")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n\t\t"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//do your business")]),t._v("\n\t"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),a("h2",{attrs:{id:"springboot配置文件"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#springboot配置文件"}},[t._v("#")]),t._v(" SpringBoot配置文件")]),t._v(" "),a("p",[t._v("然后，在你的SpringBoot的application.properties或者application.yml里添加配置(这里以properties为例，yml也是一样的)")]),t._v(" "),a("div",{staticClass:"language-properties extra-class"},[a("pre",{pre:!0,attrs:{class:"language-properties"}},[a("code",[a("span",{pre:!0,attrs:{class:"token key attr-name"}},[t._v("liteflow.rule-source")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token value attr-value"}},[t._v("config/flow.xml")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#-----------------以下非必须-----------------")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#liteflow是否开启，默认为true")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token key attr-name"}},[t._v("liteflow.enable")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token value attr-value"}},[t._v("true")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#liteflow的banner是否开启，默认为true")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token key attr-name"}},[t._v("liteflow.print-banner")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token value attr-value"}},[t._v("true")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#zkNode的节点，只有使用zk作为配置源的时候才起作用")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token key attr-name"}},[t._v("liteflow.zk-node")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token value attr-value"}},[t._v("/lite-flow/flow")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#slot的数量，默认值为1024")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token key attr-name"}},[t._v("liteflow.slot-size")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token value attr-value"}},[t._v("1024")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#FlowExecutor的execute2Future的线程数，默认为64")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token key attr-name"}},[t._v("liteflow.main-executor-works")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token value attr-value"}},[t._v("64")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#FlowExecutor的execute2Future的自定义线程池Builder，LiteFlow提供了默认的Builder")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token key attr-name"}},[t._v("liteflow.main-executor-class")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token value attr-value"}},[t._v("com.yomahub.liteflow.thread.LiteFlowDefaultMainExecutorBuilder")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#并行节点的线程池Builder，LiteFlow提供了默认的Builder")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token key attr-name"}},[t._v("liteflow.thread-executor-class")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token value attr-value"}},[t._v("com.yomahub.liteflow.thread.LiteFlowDefaultWhenExecutorBuilder")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#异步线程最长的等待时间秒(只用于when)，默认值为16")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token key attr-name"}},[t._v("liteflow.when-max-wait-seconds")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token value attr-value"}},[t._v("20")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#异步线程池最大线程数，默认为16")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token key attr-name"}},[t._v("liteflow.when-max-workers")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token value attr-value"}},[t._v("16")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#异步线程池等待队列数，默认为512")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token key attr-name"}},[t._v("liteflow.when-queue-limit")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token value attr-value"}},[t._v("512")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#是否在启动的时候就解析规则，默认为true")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token key attr-name"}},[t._v("liteflow.parse-on-start")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token value attr-value"}},[t._v("true")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#全局重试次数，默认为0")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token key attr-name"}},[t._v("liteflow.retry-count")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token value attr-value"}},[t._v("0")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#是否支持不同类型的加载方式混用，默认为false")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token key attr-name"}},[t._v("liteflow.support-multiple-type")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token value attr-value"}},[t._v("false")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#是否开启监控log打印，默认值为false")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token key attr-name"}},[t._v("liteflow.monitor.enable-log")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token value attr-value"}},[t._v("true")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#监控队列存储大小，默认值为200")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token key attr-name"}},[t._v("liteflow.monitor.queue-limit")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token value attr-value"}},[t._v("300")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#监控一开始延迟多少执行，默认值为300000毫秒，也就是5分钟")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token key attr-name"}},[t._v("liteflow.monitor.delay")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token value attr-value"}},[t._v("10000")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#监控日志打印每过多少时间执行一次，默认值为300000毫秒，也就是5分钟")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token key attr-name"}},[t._v("liteflow.monitor.period")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token value attr-value"}},[t._v("10000")]),t._v("\n")])])]),a("h2",{attrs:{id:"规则文件的定义"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#规则文件的定义"}},[t._v("#")]),t._v(" 规则文件的定义")]),t._v(" "),a("p",[t._v("同时，你得在resources下的"),a("code",[t._v("config/flow.xml")]),t._v("中定义规则：")]),t._v(" "),a("div",{staticClass:"language-xml extra-class"},[a("pre",{pre:!0,attrs:{class:"language-xml"}},[a("code",[a("span",{pre:!0,attrs:{class:"token prolog"}},[t._v('<?xml version="1.0" encoding="UTF-8"?>')]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("flow")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("chain")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("name")]),a("span",{pre:!0,attrs:{class:"token attr-value"}},[a("span",{pre:!0,attrs:{class:"token punctuation attr-equals"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')]),t._v("chain1"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')])]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("then")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("value")]),a("span",{pre:!0,attrs:{class:"token attr-value"}},[a("span",{pre:!0,attrs:{class:"token punctuation attr-equals"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')]),t._v("a,b,c"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')])]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("/>")])]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("when")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("value")]),a("span",{pre:!0,attrs:{class:"token attr-value"}},[a("span",{pre:!0,attrs:{class:"token punctuation attr-equals"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')]),t._v("d,e"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')])]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("/>")])]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("chain")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("flow")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n")])])]),a("p",[t._v("SpringBoot在启动时会自动装载规则文件。")])])}),[],!1,null,null,null);a.default=e.exports}}]);